ALTER SESSION SET CONTAINER=INSTITUTO;
WHENEVER SQLERROR EXIT SQL.SQLCODE;

-- Creamos tabla de profesores
CREATE TABLE profesores (
  id_profesor NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nombre VARCHAR2(100 CHAR),
  especialidad VARCHAR2(100 CHAR)
);

-- Insertamos los profesores
INSERT INTO profesores (nombre, especialidad) VALUES ('Alejandro Roca Alhama', 'Sistemas');
INSERT INTO profesores (nombre, especialidad) VALUES ('Jose Antonio Moñino', 'Aplicaciones Web');
INSERT INTO profesores (nombre, especialidad) VALUES ('Antonio Pelegrin', 'Servicios en Red');
INSERT INTO profesores (nombre, especialidad) VALUES ('Cayetano Reinaldos Duarte', 'Base de datos');
INSERT INTO profesores (nombre, especialidad) VALUES ('Samuel Rabadan', 'Seguridad Informática');
INSERT INTO profesores (nombre, especialidad) VALUES ('Miguel Angel Ibañez', 'Redes');

-- Creamos tabla de alumnos
CREATE TABLE alumnos (
  id_alumno NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nombre VARCHAR2(100 CHAR),
  curso VARCHAR2(50 CHAR)
);

-- Insertamos los alumnos
INSERT INTO alumnos (nombre, curso) VALUES ('Juan Carrasco Milla', '2 ASIR');
INSERT INTO alumnos (nombre, curso) VALUES ('Victor Manuel Andreu Felipe', '2 ASIR');
INSERT INTO alumnos (nombre, curso) VALUES ('Alejandro Burruezo Burru', '2 ASIR');
INSERT INTO alumnos (nombre, curso) VALUES ('Jose Corominas Pepe', '2 ASIR');
INSERT INTO alumnos (nombre, curso) VALUES ('Pablo Guerrero Bernal', '2 ASIR');
INSERT INTO alumnos (nombre, curso) VALUES ('Moises Lacabra GOAT', '2 ASIR');

-- Creamos tabla de cursos
CREATE TABLE cursos (
  id_curso NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nombre VARCHAR2(50 CHAR)
);

-- Insertamos cursos
INSERT INTO cursos (nombre) VALUES ('2 ASIR');

-- Creamos tabla de asignaturas
CREATE TABLE asignaturas (
  id_asignatura NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nombre VARCHAR2(100 CHAR),
  profesor_id NUMBER,
  CONSTRAINT fk_profesor FOREIGN KEY (profesor_id) REFERENCES profesores(id_profesor)
);

-- Insertamos asignaturas y asignamos profesores
INSERT INTO asignaturas (nombre, profesor_id) VALUES ('Redes', 6); -- Miguel Angel Ibañez
INSERT INTO asignaturas (nombre, profesor_id) VALUES ('Sistemas', 1); -- Alejandro Roca Alhama
INSERT INTO asignaturas (nombre, profesor_id) VALUES ('Aplicaciones Web', 2); -- Jose Antonio Moñino
INSERT INTO asignaturas (nombre, profesor_id) VALUES ('Seguridad', 5); -- Samuel Rabadan

-- Creamos tabla de matriculas
CREATE TABLE matriculas (
  id_matricula NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  alumno_id NUMBER,
  asignatura_id NUMBER,
  nota NUMBER(3,1),
  CONSTRAINT fk_alumno FOREIGN KEY (alumno_id) REFERENCES alumnos(id_alumno),
  CONSTRAINT fk_asignatura FOREIGN KEY (asignatura_id) REFERENCES asignaturas(id_asignatura)
);

-- Insertamos algunas matriculas
INSERT INTO matriculas (alumno_id, asignatura_id, nota) VALUES (1, 1, 8.5);
INSERT INTO matriculas (alumno_id, asignatura_id, nota) VALUES (2, 2, 7.0);
INSERT INTO matriculas (alumno_id, asignatura_id, nota) VALUES (3, 3, 9.0);
INSERT INTO matriculas (alumno_id, asignatura_id, nota) VALUES (4, 1, 6.5);
INSERT INTO matriculas (alumno_id, asignatura_id, nota) VALUES (5, 4, 7.5);
INSERT INTO matriculas (alumno_id, asignatura_id, nota) VALUES (6, 2, 8.0);

COMMIT;
EXIT;
