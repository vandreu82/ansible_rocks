---
- name: Crear base de datos INSTITUTO
  ansible.builtin.command: >
    dbca -silent
    -createDatabase
    -gdbName INSTITUTO
    -sid INSTITUTO
    -templateName General_Purpose.dbc
    -createAsContainerDatabase false
    -characterSet AL32UTF8
    -memoryMgmtType auto_sga
    -emConfiguration NONE
    -sysPassword Oracle123
    -systemPassword Oracle123
  become_user: oracle

- name: Copiar script SQL con los registros de profesores
  ansible.builtin.copy:
    dest: /home/oracle/instituto.sql
    content: |
      CREATE TABLE profesores (
        id_profesor NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
        nombre VARCHAR2(100),
        especialidad VARCHAR2(100)
      );

      INSERT INTO profesores (nombre, especialidad) VALUES ('Alejandro Roca Alhama', 'Sistemas');
      INSERT INTO profesores (nombre, especialidad) VALUES ('Jose Antonio Moñino', 'Aplicaciones Web');
      INSERT INTO profesores (nombre, especialidad) VALUES ('Antonio Pelegrin', 'Servicios en Red');
      INSERT INTO profesores (nombre, especialidad) VALUES ('Cayetano Reinaldos Duarte', 'Base de datos');
      INSERT INTO profesores (nombre, especialidad) VALUES ('Samuel Rabadan', 'Seguridad Informática');
      INSERT INTO profesores (nombre, especialidad) VALUES ('Miguel Angel Ibañez', 'Redes');

      COMMIT;

- name: Insertar registros de profesores
  ansible.builtin.command: >
    . /home/oracle/.bash_profile && echo "exit" | sqlplus sys/Oracle123@INSTITUTO as sysdba @/home/oracle/instituto.sql
  become_user: oracle
