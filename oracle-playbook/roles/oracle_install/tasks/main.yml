---
- name: Crear /u01/app/ si no existe
  ansible.builtin.file:
    path: /u01/app/oracle/product/19c/dbhome_1
    state: directory
    owner: oracle
    group: oinstall
    mode: '0755'

- name: Descomprimir instalador de Oracle en el host remoto
  ansible.builtin.unarchive:
    src: "/tmp/LINUX.X64_193000_db_home.zip"
    dest: "/u01/app/oracle/product/19c/dbhome_1/"
    remote_src: yes

- name: Descomprimir instaladores
  ansible.builtin.unarchive:
    src: "/tmp/{{ item }}"
    dest: /u01/app/oracle/product/19c/dbhome_1/
    remote_src: yes
  loop: "{{ oracle_installers }}"

- name: Dar permisos completos de /u01 a oracle
  ansible.builtin.command: chown -R oracle:oinstall /u01
  become: yes

- name: Asegurar permisos de ejecuciÃ³n en /u01
  ansible.builtin.command: chmod -R 755 /u01
  become: yes

- name: Ejecutar runInstaller en modo silent
  ansible.builtin.command: >
    /u01/app/oracle/product/19c/dbhome_1/runInstaller -silent -responseFile /u01/app/oracle/product/19c/dbhome_1/install/response/db_install.rsp -ignorePrereqFailure
  become_user: oracle

# tasks file for roles/oracle_install
